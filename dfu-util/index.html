<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="../sakura.css" />
    <title>Kiwrious DFU</title>
    <script src="dfu.js"></script>
    <script src="dfuse.js"></script>
    <script src="FileSaver.js"></script>
    <script src="dfu-util.js"></script>
    <style>
      p.warning {
        color: red;
      }
      p.error {
        color: red;
        font-weight: bold;
      }
      label.radio {
        display: inline;
      }
      input:invalid {
        color:red;
      }
    </style>
  </head>
  <body>
    
    <p>
      <span id="status"></span>
    </p>
    <p>
      
      <input  hidden="true" list="vendor_ids" type="text" name="vid" id="vid" maxlength="6" size="8" pattern="0x[A-Fa-f0-9]{1,4}"/>
      <datalist id="vendor_ids">
        <option value="0x1209">dapboot DFU bootloader</option>
        <option value="0x0D28">mbed DAPLink</option>
        <option value="0x1EAF">LeafLabs Maple/stm32duino bootloader</option>
      </datalist>
    </p>
    <h2>Kiwrious  UV sensor update utility</h2>
    <p>
      1: Click Step 1 and select the Kiwrious Sensor <br>
      2: Click Step 2 and select the Kiwrious DFU <br>
      3: Click Step 3 <br>
      4: Update is complete. Please unplug the sensor and plug it back in.
    </p>
    
      <button id="connect">Step 1</button>
	  
    >>
      <button id="connect2" disabled="true">Step 2</button>
	  
  >>
     <button id="download" disabled="true">Step 3</button>
	
   
    <dialog id="interfaceDialog">
      Your device has multiple DFU interfaces. Select one from the list below:
      <form id="interfaceForm" method="dialog">
        <button id="selectInterface" type="submit">Select interface</button>
      </form>
    </dialog>
    <p>
      <div id="usbInfo" style="white-space: pre"></div>
      <div id="dfuInfo" style="white-space: pre"></div>
    </p>
    <fieldset >
      <legend hidden="true">Runtime mode</legend>
      <button hidden="true" id="detach" disabled="true">Detach DFU</button>
    </fieldset>
    <fieldset>
      <form id="configForm">
        <input hidden="true" type="number" name="transferSize" id="transferSize" value="1024"/>
        <div id="dfuseFields" hidden="true">
          <label for="dfuseStartAddress">DfuSe Start Address:</label>
          <input type="text" name="dfuseStartAddress" id="dfuseStartAddress" title="Initial memory address to read/write from (hex)" size="10" pattern="0x[A-Fa-f0-9]+"/>
          <label for="dfuseUploadSize">DfuSe Upload Size:</label>
          <input type="number" name="dfuseUploadSize" id="dfuseUploadSize" min="1"/>
        </div>
      
        <legend hidden="true">DFU mode</legend>
        <fieldset>
          <legend>Firmware Download (write to USB device)</legend>
          <p>
            <input hidden="true" type="file" id="firmwareFile" name="file" disabled="true"/>
          </p>
          <p>
           
          </p>
          <div class="log" id="downloadLog"></div>
        </fieldset>
        
      </form>
    </fieldset>
    <h1>About</h1>
    <p>
      This is a tool to update the firmware on Kiwrious Sensors. Based on the proof-of-concept demo by @devanlai. Source: <a href="https://devanlai.github.io/webdfu/dfu-util/">Git Repo</a> 
    </p>
    
      
    <ul>
  </body>
</html>
